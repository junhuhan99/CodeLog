================================================================================
CodeLog - ë¹Œë“œ ì—ëŸ¬ í•´ê²° ê°€ì´ë“œ
================================================================================

ğŸ› ë°œìƒí•œ ì—ëŸ¬: "Uncaught (in promise) TypeError: p is not a function"
ğŸ“… í•´ê²°ì¼: 2025-10-13
âœ… ìƒíƒœ: í•´ê²° ì™„ë£Œ

================================================================================
1. ì—ëŸ¬ ìƒì„¸ ì •ë³´
================================================================================

ì—ëŸ¬ ë©”ì‹œì§€:
--------------
index-am-xzKPU.js:217 Uncaught (in promise) TypeError: p is not a function
    at B (index-am-xzKPU.js:217:27503)

ë°œìƒ ìœ„ì¹˜:
--------------
- íŒŒì¼: frontend/src/pages/ProjectDetail.jsx
- í•¨ìˆ˜: handleDownloadBuild
- ë¼ì¸: 217-247

ë°œìƒ ì‹œì :
--------------
- ë¹Œë“œ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ í´ë¦­ ì‹œ
- í”„ë¡ íŠ¸ì—”ë“œ ë¹Œë“œ í›„ ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰ ì‹œ

================================================================================
2. ì—ëŸ¬ ì›ì¸ ë¶„ì„
================================================================================

2.1. ê·¼ë³¸ ì›ì¸
--------------
axios (api.get)ë¥¼ ì‚¬ìš©í•  ë•Œ responseType: 'blob' ì˜µì…˜ì´ Vite ë¹Œë“œ ê³¼ì •ì—ì„œ
ì œëŒ€ë¡œ ì²˜ë¦¬ë˜ì§€ ì•Šì•„ ë°œìƒ

ë¬¸ì œê°€ ëœ ì½”ë“œ:
```javascript
const response = await api.get(`/projects/${id}/builds/${buildId}/download`, {
  responseType: 'blob'  // â† ì—¬ê¸°ì„œ ë¬¸ì œ ë°œìƒ
})
```

2.2. ì™œ ê°œë°œ í™˜ê²½ì—ì„œëŠ” ë™ì‘í–ˆë‚˜?
--------------
- Vite dev ëª¨ë“œ: Hot Module Replacement (HMR) ì‚¬ìš©
- ë¹Œë“œ ëª¨ë“œ: ì½”ë“œ ì••ì¶•(minification) ë° tree-shaking ì ìš©
- ë¹Œë“œ ê³¼ì •ì—ì„œ axiosì˜ ì¼ë¶€ ê¸°ëŠ¥ì´ ì˜ëª» ë²ˆë“¤ë§ë¨

2.3. ë¹„ìŠ·í•œ ì—ëŸ¬ê°€ ë°œìƒí•  ìˆ˜ ìˆëŠ” ê²½ìš°
--------------
- axios interceptor ë¬¸ì œ
- dynamic import ë¬¸ì œ
- async/await ì²´ì¸ ë¬¸ì œ
- blob/file ì²˜ë¦¬ ë¬¸ì œ

================================================================================
3. í•´ê²° ë°©ë²• (ì ìš© ì™„ë£Œ âœ…)
================================================================================

3.1. fetch API ì‚¬ìš©ìœ¼ë¡œ ë³€ê²½
--------------
axios ëŒ€ì‹  ë„¤ì´í‹°ë¸Œ fetch API ì‚¬ìš©

ë³€ê²½ ì „:
```javascript
const response = await api.get(`/projects/${id}/builds/${buildId}/download`, {
  responseType: 'blob'
})
const url = window.URL.createObjectURL(new Blob([response.data]))
```

ë³€ê²½ í›„:
```javascript
fetch(downloadUrl, {
  headers: {
    'Authorization': `Bearer ${token}`
  }
})
.then(response => response.blob())
.then(blob => {
  const url = window.URL.createObjectURL(blob)
  // ë‹¤ìš´ë¡œë“œ ì²˜ë¦¬
})
```

3.2. ê°œì„  ì‚¬í•­
--------------
1. ë¹Œë“œ ìƒíƒœ ì‚¬ì „ í™•ì¸ ì¶”ê°€
2. ì—ëŸ¬ í•¸ë“¤ë§ ê°•í™”
3. íŒŒì¼ëª… ìë™ ìƒì„±
4. ë” ì•ˆì •ì ì¸ blob ì²˜ë¦¬

3.3. ì „ì²´ ìˆ˜ì •ëœ ì½”ë“œ
--------------
íŒŒì¼: frontend/src/pages/ProjectDetail.jsx

```javascript
const handleDownloadBuild = async (buildId) => {
  try {
    // 1. ë¹Œë“œ ì •ë³´ ë¨¼ì € í™•ì¸
    const buildInfo = await api.get(`/projects/${id}/builds/${buildId}`)

    if (buildInfo.data.build.build_status !== 'success') {
      showAlert('error', 'ë¹Œë“œê°€ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤')
      return
    }

    // 2. ë‹¤ìš´ë¡œë“œ URL ìƒì„±
    const token = localStorage.getItem('token')
    const downloadUrl = `${import.meta.env.VITE_API_URL || 'http://localhost:5000'}/api/projects/${id}/builds/${buildId}/download`

    // 3. fetchë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ìš´ë¡œë“œ
    fetch(downloadUrl, {
      headers: {
        'Authorization': `Bearer ${token}`
      }
    })
    .then(response => {
      if (!response.ok) throw new Error('Download failed')
      return response.blob()
    })
    .then(blob => {
      // 4. Blobì„ URLë¡œ ë³€í™˜
      const url = window.URL.createObjectURL(blob)
      const a = document.createElement('a')
      a.href = url

      // 5. íŒŒì¼ëª… ìë™ ìƒì„±
      a.download = `${project.app_name.replace(/\s+/g, '_')}_${buildInfo.data.build.version_name}.${buildInfo.data.build.build_type}`

      // 6. ë‹¤ìš´ë¡œë“œ íŠ¸ë¦¬ê±°
      document.body.appendChild(a)
      a.click()

      // 7. ì •ë¦¬
      window.URL.revokeObjectURL(url)
      a.remove()

      showAlert('success', 'ë¹Œë“œ íŒŒì¼ ë‹¤ìš´ë¡œë“œê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤')
    })
    .catch(err => {
      console.error('Download error:', err)
      showAlert('error', 'ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤')
    })
  } catch (error) {
    console.error('Download error:', error)
    showAlert('error', error.response?.data?.error || 'ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤')
  }
}
```

================================================================================
4. ì¬ë°°í¬ ë°©ë²•
================================================================================

4.1. ë¡œì»¬ì—ì„œ Git ì‚¬ìš© (ê¶Œì¥)
--------------
# PowerShell
cd D:\CodeLog
git add .
git commit -m "Fix: download function error"
git push origin main

# EC2 ì„œë²„
ssh -i codelog-keypair.pem ubuntu@YOUR_EC2_IP
cd ~/CodeLog
git pull origin main
docker compose down
docker compose up -d --build


4.2. SCPë¡œ íŒŒì¼ ì „ì†¡
--------------
# PowerShell
scp -i codelog-keypair.pem D:\CodeLog\frontend\src\pages\ProjectDetail.jsx ubuntu@YOUR_EC2_IP:~/CodeLog/frontend/src/pages/

# EC2 ì„œë²„
ssh -i codelog-keypair.pem ubuntu@YOUR_EC2_IP
cd ~/CodeLog
docker compose down
docker compose up -d --build

================================================================================
5. í…ŒìŠ¤íŠ¸ ë°©ë²•
================================================================================

5.1. ë¡œì»¬ í…ŒìŠ¤íŠ¸ (ë°°í¬ ì „)
--------------
cd D:\CodeLog\frontend
npm run build

# ì—ëŸ¬ê°€ ì—†ìœ¼ë©´ ì„±ê³µ!
# dist í´ë” í™•ì¸


5.2. ì„œë²„ ë°°í¬ í›„ í…ŒìŠ¤íŠ¸
--------------
1. ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ì†
   http://YOUR_EC2_IP

2. ë¡œê·¸ì¸

3. í”„ë¡œì íŠ¸ ìƒì„± ë˜ëŠ” ê¸°ì¡´ í”„ë¡œì íŠ¸ ì„ íƒ

4. ë¹Œë“œ íƒ­ ì´ë™

5. APK ë¹Œë“œ ì‹œì‘

6. ë¹Œë“œ ì™„ë£Œ í›„ (5-10ë¶„)

7. ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ í´ë¦­

8. APK íŒŒì¼ ë‹¤ìš´ë¡œë“œ í™•ì¸
   ì˜ˆ: MyApp_1.0.0.apk

================================================================================
6. ë¹Œë“œ ì—ëŸ¬ í™•ì¸ ë°©ë²•
================================================================================

6.1. ê°œë°œ í™˜ê²½ (ë¡œì»¬)
--------------
# í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ ì„œë²„
cd D:\CodeLog\frontend
npm run dev

# ë¸Œë¼ìš°ì € ì½˜ì†” í™•ì¸ (F12)
# ì—ëŸ¬ê°€ ìˆìœ¼ë©´ ë°”ë¡œ í‘œì‹œë¨


6.2. í”„ë¡œë•ì…˜ ë¹Œë“œ
--------------
cd D:\CodeLog\frontend
npm run build

# ë¹Œë“œ ì„±ê³µ ì‹œ:
# âœ“ built in 10.5s

# ë¹Œë“œ ì‹¤íŒ¨ ì‹œ:
# âœ— Build failed
# [ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ]


6.3. ì„œë²„ ë¡œê·¸ í™•ì¸
--------------
# EC2 ì„œë²„ì—ì„œ
docker compose logs -f frontend

# ì—ëŸ¬ ê²€ìƒ‰
docker compose logs frontend | grep -i error

================================================================================
7. ì¼ë°˜ì ì¸ React/Vite ë¹Œë“œ ì—ëŸ¬
================================================================================

7.1. "X is not a function"
--------------
ì›ì¸:
- Import ê²½ë¡œ ì˜¤ë¥˜
- í•¨ìˆ˜ ëŒ€ì‹  ê°ì²´ë¥¼ í˜¸ì¶œ
- ë¹Œë“œ ê³¼ì •ì—ì„œ tree-shaking ë¬¸ì œ

í•´ê²°:
- Import í™•ì¸
- í•¨ìˆ˜ í˜¸ì¶œ ë°©ì‹ í™•ì¸
- ë„¤ì´í‹°ë¸Œ API ì‚¬ìš© ê³ ë ¤


7.2. "Cannot read property 'X' of undefined"
--------------
ì›ì¸:
- ê°ì²´ê°€ ì´ˆê¸°í™”ë˜ê¸° ì „ ì ‘ê·¼
- Async ë°ì´í„° ì²˜ë¦¬ ë¬¸ì œ

í•´ê²°:
- Optional chaining ì‚¬ìš© (?.)
- ì´ˆê¸°ê°’ ì„¤ì •
- ì¡°ê±´ë¶€ ë Œë”ë§


7.3. "Module not found"
--------------
ì›ì¸:
- ì˜ì¡´ì„± ë¯¸ì„¤ì¹˜
- Import ê²½ë¡œ ì˜¤ë¥˜

í•´ê²°:
npm install
npm run build


7.4. "Memory limit exceeded"
--------------
ì›ì¸:
- í° íŒŒì¼ ì²˜ë¦¬
- ë¬´í•œ ë£¨í”„

í•´ê²°:
# ë©”ëª¨ë¦¬ ëŠ˜ë¦¬ê¸°
NODE_OPTIONS=--max_old_space_size=4096 npm run build

================================================================================
8. ì˜ˆë°© ë°©ë²•
================================================================================

8.1. ê°œë°œ ì¤‘
--------------
1. ìì£¼ í…ŒìŠ¤íŠ¸
   npm run build

2. íƒ€ì… ì²´í¬ (TypeScript ì‚¬ìš© ì‹œ)
   npm run type-check

3. Lint ì‚¬ìš©
   npm run lint


8.2. ë°°í¬ ì „
--------------
1. ë¡œì»¬ í”„ë¡œë•ì…˜ ë¹Œë“œ í…ŒìŠ¤íŠ¸
   npm run build
   npm run preview

2. ë¸Œë¼ìš°ì € ì½˜ì†” í™•ì¸

3. ì£¼ìš” ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸


8.3. ì½”ë”© ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤
--------------
1. Try-catch ì‚¬ìš©
2. ì—ëŸ¬ ë¡œê¹…
3. íƒ€ì… ì²´í¬
4. ì½”ë“œ ë¦¬ë·°
5. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

================================================================================
9. ì¶”ê°€ ë„êµ¬
================================================================================

9.1. ì—ëŸ¬ ì¶”ì  ë„êµ¬
--------------
- Sentry: í”„ë¡œë•ì…˜ ì—ëŸ¬ ì¶”ì 
- LogRocket: ì„¸ì…˜ ë¦¬í”Œë ˆì´
- Browser DevTools: ê°œë°œ ì¤‘ ë””ë²„ê¹…


9.2. ë¹Œë“œ ë¶„ì„
--------------
# Vite ë²ˆë“¤ ë¶„ì„
npm run build -- --mode=analyze

# Webpack bundle analyzer (ì‚¬ìš© ì‹œ)
npm install -D webpack-bundle-analyzer

================================================================================
10. ì²´í¬ë¦¬ìŠ¤íŠ¸
================================================================================

â–¡ ì—ëŸ¬ ì›ì¸ íŒŒì•…
â–¡ ì½”ë“œ ìˆ˜ì •
â–¡ ë¡œì»¬ ë¹Œë“œ í…ŒìŠ¤íŠ¸
â–¡ Git ì»¤ë°‹
â–¡ ì„œë²„ì— ë°°í¬
â–¡ ì„œë²„ ì¬ì‹œì‘
â–¡ ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸
â–¡ ë¡œê·¸ í™•ì¸
â–¡ ê¸°ëŠ¥ ê²€ì¦

================================================================================
11. ì¶”ê°€ ì°¸ê³  ìë£Œ
================================================================================

Vite ë¬¸ì„œ:
https://vitejs.dev/

React ë¬¸ì„œ:
https://react.dev/

Axios ë¬¸ì„œ:
https://axios-http.com/

Fetch API:
https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API

================================================================================
ìš”ì•½
================================================================================

âœ… ë¬¸ì œ: axios blob ì²˜ë¦¬ ì‹œ ë¹Œë“œ ì—ëŸ¬
âœ… í•´ê²°: fetch APIë¡œ ë³€ê²½
âœ… ìƒíƒœ: ìˆ˜ì • ì™„ë£Œ
âœ… íŒŒì¼: frontend/src/pages/ProjectDetail.jsx
âœ… í…ŒìŠ¤íŠ¸: ë¡œì»¬ ë¹Œë“œ ì„±ê³µ
âœ… ë°°í¬: ì¬ë°°í¬ ê°€ì´ë“œ ì°¸ì¡°

ì´ì œ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤!

================================================================================
ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: 2025-10-13
ì‘ì„±ì: Logs0
================================================================================
